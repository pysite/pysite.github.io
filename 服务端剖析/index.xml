<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>服务端剖析 on workwiki</title>
    <link>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/</link>
    <description>Recent content in 服务端剖析 on workwiki</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language><atom:link href="/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>公共服</title>
      <link>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E5%85%AC%E5%85%B1%E6%9C%8D/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E5%85%AC%E5%85%B1%E6%9C%8D/</guid>
      <description>调用图 graph TD 客户端APP --&gt; loop loop --&gt; IgnoreLogin(无需登陆) loop --&gt; AfterLogin(要求登陆) loop --&gt; RegisterLogin(登陆) AfterLogin --&gt; 设置用户 AfterLogin --&gt; 充值列表 AfterLogin(要求登陆) --&gt; 打盾场次列表 AfterLogin(要求登陆) --&gt; 战绩列表 AfterLogin(要求登陆) --&gt; 其他命令... 设置用户 --&gt; set_user.go 充值列表 --&gt; recharge_list.go 打盾场次列表 --&gt; game_510k.go 战绩列表 --&gt; archive_detail.go </description>
    </item>
    
    <item>
      <title>公共库</title>
      <link>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E5%85%AC%E5%85%B1%E5%BA%93/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E5%85%AC%E5%85%B1%E5%BA%93/</guid>
      <description>代码目录: common/flow
子目录:
event:protobuf自动产生,建议不要手工编辑 proto_file:protobuf协议定义,用于flow和客户app通讯,实现不同游戏的公共协议 子文件:
base_flow.go:实现流程图的BaseFlow base_room.go:实现流程图的BaseRoom,主要实现Roomer接口 base_room_inside.go:实现流程图的BaseRoom,房间通用功能,部分供GameRoom调用 conn_manage.go:实现流程图的tcp链接管理 lobby.go:实现游戏桌子列表功能 log_msg.go:记录客户端和游戏服收发包日志 loop.go:tcp监听和游戏服务注册 packer.go:定义Tcp协程和BaseFlow参数 player.go:实现流程图的BasePlay room_manage.go:实现流程图的房间管理 roomer.go:实现流程图的roomer接口 status.go:定义flow给客户端错误代码 timer.go:每分钟定时任务 git代码管理:dev分支</description>
    </item>
    
    <item>
      <title>麻将流程图</title>
      <link>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E9%BA%BB%E5%B0%86%E6%B5%81%E7%A8%8B%E5%9B%BE/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E9%BA%BB%E5%B0%86%E6%B5%81%E7%A8%8B%E5%9B%BE/</guid>
      <description>流程图 graph TD 准备 --&gt;开始[开始游戏] 开始--&gt;检查庄家胡[开局检查天胡] 检查庄家胡--&gt;|Y| 胡[胡牌] 检查庄家胡--&gt;|N| 出牌[出牌] 出牌--&gt;检查碰杠胡[检查碰/杠/胡] 检查碰杠胡--&gt;玩家选择碰杠胡过[玩家选择碰/杠/胡/过] 玩家选择碰杠胡过--&gt;|杠|杠[杠] 玩家选择碰杠胡过--&gt;|胡|胡[胡] 玩家选择碰杠胡过--&gt;|碰|碰[碰] 玩家选择碰杠胡过--&gt;|过|过[过] 过--&gt;下家摸牌[下家摸牌] 碰--&gt;出牌[出牌] 下家摸牌--&gt;出牌[出牌] 杠--&gt;出牌玩家摸牌[出牌玩家摸牌] 出牌玩家摸牌--&gt;出牌[出牌] 胡--&gt;结算[结算] 碰/杠,胡时,碰/杠先操作 sequenceDiagram 玩家1-&gt;&gt;服务器:玩家1出牌|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家2:提示碰/杠|HINTOUT 服务器--&gt;&gt;玩家3:提示胡|HINTOUT 服务器--&gt;&gt;玩家4:等待操作|WAITOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 玩家2-&gt;&gt;服务器:碰/杠|ASKOUT 服务器--&gt;&gt;玩家2:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家3-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家3胡牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家3胡牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家3胡牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家3胡牌|USEOUT 可碰/杠,碰/杠先操作且胡过 sequenceDiagram 玩家1-&gt;&gt;服务器:玩家1出牌|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家2:提示碰/杠|HINTOUT 服务器--&gt;&gt;玩家3:提示胡|HINTOUT 服务器--&gt;&gt;玩家4:等待操作|WAITOUT 玩家2-&gt;&gt;服务器:碰/杠|ASKOUT 服务器--&gt;&gt;玩家2:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家3-&gt;&gt;服务器:过|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家2碰/杠|USEOUT 服务器--&gt;&gt;玩家2:广播玩家2碰/杠|USEOUT 服务器--&gt;&gt;玩家3:广播玩家2碰/杠|USEOUT 服务器--&gt;&gt;玩家4:广播玩家2碰/杠|USEOUT 碰/杠 /胡都选择过 sequenceDiagram 玩家1-&gt;&gt;服务器:玩家1出牌|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家2:提示碰/杠|HINTOUT 服务器--&gt;&gt;玩家3:提示胡|HINTOUT 服务器--&gt;&gt;玩家4:等待操作|WAITOUT 玩家2-&gt;&gt;服务器:过|ASKOUT 服务器--&gt;&gt;玩家2:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家3-&gt;&gt;服务器:过|ASKOUT 服务器--&gt;&gt;玩家2:给玩家2发牌(提示出牌)|HINTOUT 服务器--&gt;&gt;玩家1:等待玩家2出牌|WAITOUT 服务器--&gt;&gt;玩家3:等待玩家2出牌|WAITOUT 服务器--&gt;&gt;玩家4:等待玩家2出牌|WAITOUT 碰/杠,胡时,胡先操作 sequenceDiagram 玩家1-&gt;&gt;服务器:玩家1出牌|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家2:提示碰/杠|HINTOUT 服务器--&gt;&gt;玩家3:提示胡|HINTOUT 服务器--&gt;&gt;玩家4:提示等待WAITOUT 玩家3-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家3胡牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家3胡牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家3胡牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家3胡牌|USEOUT 玩家2-&gt;&gt;服务器:碰/杠|ASKOUT 服务器--&gt;&gt;玩家2:错误码|RETURN 两个玩家可以胡,一个玩家可以碰/杠 sequenceDiagram 玩家1-&gt;&gt;服务器:玩家1出牌|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家2:提示碰/杠|HINTOUT 服务器--&gt;&gt;玩家3:提示胡|HINTOUT 服务器--&gt;&gt;玩家4:提示胡|HINTOUT 玩家4-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家4:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家2-&gt;&gt;服务器:碰/杠|ASKOUT 服务器--&gt;&gt;玩家2:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家3-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家2:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家3:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家4:广播玩家3,4胡牌|MultiUseOut 两个玩家可以胡,一个玩家可以碰 sequenceDiagram 玩家1-&gt;&gt;服务器:玩家1出牌|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家2:提示碰/杠|HINTOUT 服务器--&gt;&gt;玩家3:提示胡|HINTOUT 服务器--&gt;&gt;玩家4:提示胡|HINTOUT 玩家4-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家4:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家3-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家2:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家3:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家4:广播玩家3,4胡牌|MultiUseOut 玩家2-&gt;&gt;服务器:碰/杠|ASKOUT 服务器--&gt;&gt;玩家2:错误码 两个胡一个碰/杠 sequenceDiagram 玩家1-&gt;&gt;服务器:玩家1出牌|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1出牌|USEOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家2:提示碰/杠|HINTOUT 服务器--&gt;&gt;玩家3:提示胡|HINTOUT 服务器--&gt;&gt;玩家4:提示胡|HINTOUT 玩家2-&gt;&gt;服务器:碰/杠|ASKOUT 服务器--&gt;&gt;玩家2:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家4-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家4:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家3-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家2:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家3:广播玩家3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家4:广播玩家3,4胡牌|PBMultiUseOut 补杠 sequenceDiagram 玩家1-&gt;&gt;服务器:补杠|ASKOUT 服务器--&gt;&gt;玩家2:提示胡|HINTOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家3:等待操作|WAITOUT 服务器--&gt;&gt;玩家4:等待操作|WAITOUT 玩家2-&gt;&gt;服务器:过|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1补杠成功|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1补杠成功|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1补杠成功|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1补杠成功|USEOUT 抢杠胡 sequenceDiagram 玩家1-&gt;&gt;服务器:补杠|ASKOUT 服务器--&gt;&gt;玩家2:提示胡|HINTOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家3:等待操作|WAITOUT 服务器--&gt;&gt;玩家4:等待操作|WAITOUT 玩家2-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家2抢杠胡|USEOUT 服务器--&gt;&gt;玩家2:广播玩家2抢杠胡|USEOUT 服务器--&gt;&gt;玩家3:广播玩家2抢杠胡|USEOUT 服务器--&gt;&gt;玩家4:广播玩家2抢杠胡|USEOUT 杠上花 sequenceDiagram 玩家1-&gt;&gt;服务器:杠|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1杠|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1杠|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1杠|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1杠|USEOUT 服务器--&gt;&gt;玩家1:给玩家1发牌(+出牌/胡牌)|HINTOUT 服务器--&gt;&gt;玩家2:等待操作|WAITOUT 服务器--&gt;&gt;玩家3:等待操作|WAITOUT 服务器--&gt;&gt;玩家4:等待操作|WAITOUT 玩家1-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家1杠上花|USEOUT 服务器--&gt;&gt;玩家2:广播玩家1杠上花|USEOUT 服务器--&gt;&gt;玩家3:广播玩家1杠上花|USEOUT 服务器--&gt;&gt;玩家4:广播玩家1杠上花|USEOUT 一炮三响 sequenceDiagram 玩家1-&gt;&gt;服务器:玩家1出牌|ASKOUT 服务器--&gt;&gt;玩家1:等待操作|WAITOUT 服务器--&gt;&gt;玩家2:提示胡|HINTOUT 服务器--&gt;&gt;玩家3:提示胡|HINTOUT 服务器--&gt;&gt;玩家4:提示胡|HINTOUT 玩家4-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家4:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家3-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家3:⚠️继续等待操作|WAITOUT(isKeep=true) 玩家2-&gt;&gt;服务器:胡|ASKOUT 服务器--&gt;&gt;玩家1:广播玩家2,3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家2:广播玩家2,3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家3:广播玩家2,3,4胡牌|MultiUseOut 服务器--&gt;&gt;玩家4:广播玩家2,3,4胡牌|MultiUseOut </description>
    </item>
    
    <item>
      <title>麻将逻辑图</title>
      <link>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E9%BA%BB%E5%B0%86%E9%80%BB%E8%BE%91%E5%9B%BE/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E9%BA%BB%E5%B0%86%E9%80%BB%E8%BE%91%E5%9B%BE/</guid>
      <description>出牌 graph TD; 出牌--&gt;移除手牌[手牌中移除,添加出牌池]; 移除手牌--&gt; 广播出牌; 广播出牌--&gt;|清除所有玩家的WAITOUT/HINTOUT|其他玩家{其他玩家是否有
碰/杠/胡}; 其他玩家--&gt;|Y|操作类型[生成HINTOUT/WAITOUT]; 操作类型--&gt;|碰|碰[发送HINTOUT]; 操作类型--&gt;|杠|杠[发送HINTOUT]; 操作类型--&gt;|胡|胡[发送HINTOUT]; 操作类型--&gt;|等待|等待[发送WAITOUT]; 其他玩家--&gt;|N|给下个玩家发牌; 碰 graph TD; 碰--&gt;出牌池减少被碰的牌[被碰玩家牌池移除被碰牌]; 出牌池减少被碰的牌--&gt;手牌中移除玩家碰的牌[碰牌玩家手牌移除对子]; 手牌中移除玩家碰的牌--&gt;|添加碰牌到碰牌列表|增加碰记录[碰牌玩家增加碰记录]; 增加碰记录--&gt;|清除所有玩家的HINTOUT/WAITOUT|广播碰成功[广播碰成功]; 广播碰成功--&gt;检查暗杠{检查是否可以暗杠}; 检查暗杠--&gt;生成消息[根据检查结果生成HINTOUT]; 生成消息--&gt;|杠|杠[发送HINTOUT] 生成消息--&gt;|出牌|出牌[发送HINTOUT] 杠 graph TD; 杠--&gt;判断杠类型{判断杠类型}; 判断杠类型--&gt;|暗杠|移除暗杠牌[移除玩家手中暗杠的四张牌]; 移除暗杠牌--&gt;添加到杠牌列表; 判断杠类型--&gt;|补杠|去除碰记录[删除碰记录,移除碰列表中的碰牌,保留被碰玩家的座位信息]; 去除碰记录--&gt;添加到杠牌列表; 判断杠类型--&gt;|直杠|出牌池移除牌[被杠玩家出牌池移除被杠牌,杠牌玩家移除三张杠牌]; 出牌池移除牌--&gt;添加到杠牌列表; 添加到杠牌列表--&gt;增加杠记录; 增加杠记录--&gt;|清除所有玩家的HINTOUT/WAITOUT|广播杠成功; 广播杠成功--&gt;发牌; 胡 graph TD; 胡--&gt;|清除所有玩家的HINTOUT/WAITOUT|胡类型{判断胡类型}; 胡类型--&gt;放炮胡; 放炮胡--&gt;移除放炮的牌[移动放炮玩家的放炮牌至胡牌玩家手牌]; 移除放炮的牌--&gt;广播胡牌[广播胡牌USEOUT]; 胡类型--&gt;抢杠胡; 胡类型--&gt;自摸; 抢杠胡--&gt;移除被抢杠的牌[移动被抢杠玩家的被抢杠的牌至胡牌玩家手牌] ; 移除被抢杠的牌--&gt;广播胡牌; 自摸--&gt; 广播胡牌[广播胡牌USEOUT]; 过 graph TD; 过--&gt;|清除所有玩家的HINTOUT/WAITOUT|给下个玩家发牌[给出牌玩家的下一个玩家发牌]; 发牌 graph TD; 发牌[发牌给玩家]--&gt;牌墙减少牌; 牌墙减少牌--&gt;增加手牌[增加玩家的手牌]; 增加手牌 --&gt;|清除所有玩家的HINTOUT/WAITOUT|检查杠/胡; 检查杠/胡--&gt;胡/杠[根据检查结果生成HINTOUT]; 胡/杠--&gt;|胡|发送胡[发送HINTOUT]; 胡/杠--&gt;|杠|发送杠[发送HINTOUT]; 胡/杠--&gt;|出牌|发送出牌[发送HINTOUT]; 胡/杠--&gt;|等待|发送等待[给其他没有HINTOUT玩家发送WAITOUT] ; 多人有HINTOUT,玩家选择碰/杠胡/过 graph TD; 多人[碰/杠/胡/过]--&gt;其他玩家(判断其他玩家是否有出牌提示); 其他玩家--&gt;|Y|暂存玩家操作; 暂存玩家操作--&gt;回复继续等待[回复继续等待WAITOUT&amp;&amp;isKeep=true]; 其他玩家--&gt;|N|判断暂存(判断是否有暂存操作); 判断暂存--&gt;|Y|暂存操作[暂存玩家操作]; 暂存操作--&gt;查暂存[从暂存列表中按&#39;胡&gt;杠&gt;碰&gt;过&#39;查找出可以执行的操作]; 查暂存--&gt;结果[根据查找结果确定最后执行的流程]; 结果--&gt;|胡|执行胡[参考单人胡流程]; 结果--&gt;|杠|执行杠[参考单人杠流程]; 结果--&gt;|碰|执行碰[参考单人碰流程]; 结果--&gt;|过|执行过[参考单人过流程]; 判断暂存--&gt;|N|单人[参考单人流程]; </description>
    </item>
    
    <item>
      <title>麻将协议图</title>
      <link>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E9%BA%BB%E5%B0%86%E5%8D%8F%E8%AE%AE%E5%9B%BE/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E9%BA%BB%E5%B0%86%E5%8D%8F%E8%AE%AE%E5%9B%BE/</guid>
      <description>玩家发AskOut graph LR; 玩家AskOut -- IsForce=true --&gt;强制出牌; 玩家AskOut -- IsForce=false --&gt;非强制出牌; 强制出牌 -- action=0 --&gt;出一张牌; 强制出牌 -- action=2 --&gt;暗补杠[暗杠补杠]; 强制出牌 -- action=3 --&gt;主动胡[天胡自模杠上花]; 强制出牌 -- action=5 --&gt;取消杠/胡; 非强制出牌 -- action=1 --&gt;碰; 非强制出牌 -- action=2 --&gt;直杠; 非强制出牌 -- action=3 --&gt;被动胡[地胡点炮胡抢杠胡]; 非强制出牌 -- action=4 --&gt;过[玩家不出]; 系统派牌的出牌HINTOUT graph LR; 出牌[系统派牌的出牌HINTOUT] --&gt;|IsForce|必出[必须为true,客户端提示玩家必须从出牌/杠/胡中选择一个操作,可以取消杠/胡]; 出牌--&gt;|CanHu|可胡[若CanHu的值为true则填写下一步内容]; 可胡--&gt;HuPai[HuPai:胡的牌HuMask:胡牌类型HuTypeNum:胡牌番型]; 出牌--&gt;|CanGang|可杠[若CanGang的值为true则填写下一步内容]; 可杠--&gt;杠牌表[GangList手牌中所有可杠牌的列表]; 出牌--&gt;|CanPeng|碰[必须为false]; 碰--&gt;碰牌[Pengpai:无效]; 出牌--&gt;|HasAddPai|派牌[必须为true]; 派牌--&gt;派的牌[AddPai:必须为有效的系统派牌]; 出牌--&gt;|CursorSeatId|指向[牌桌风向标:必须为活动玩家的座位号,这里为被派牌玩家座位号]; 出牌--&gt;|QiangNum|墙牌[必须填,用于桌面上展示派牌后牌墙剩余的牌数量]; 出牌--&gt;|SeatId|座位号[必填,用于回放使用这里为被派牌玩家座位号]; 出牌--&gt;|CanOut|是否最后一张牌[最后一张派牌流局时可以为false否则派牌后必须为true]; 碰牌后的出牌HINTOUT graph LR; 出牌[碰牌后的出牌HINTOUT] --&gt;|IsForce|必出[必须为true,客户端提示玩家必须从出牌/杠中选择一个操作,可以取消杠]; 出牌--&gt;|CanGang|杠[CanGang的值为true则填写下一步内容]; 杠--&gt;杠list[GangList杠牌列表,所有可以杠的牌]; 出牌--&gt;|CanOut|CanOut[必须为true,碰完后一定可以出牌]; 出牌--&gt;|CursorSeatId|CursorSeatId[必填,牌桌风向标:指向活动玩家这里为当前出牌玩家座位号]; 出牌--&gt;|QiangNum|QiangNum[必填,用于桌面上展示剩余的牌]; 出牌--&gt;|SeatId|SeatId[必填,回放使用,这里为当前出牌玩家的座位号]; 出牌--&gt;|CanPeng|碰[必须为false]; 碰--&gt;碰牌[Pengpai:无效]; 出牌--&gt;|CanHu|胡[必须为false]; 胡--&gt;HuPai[HuPai:无效HuMask:无效HuTypeNum:无效]; 出牌--&gt;|HasAddPai|派牌[必须为false]; 派牌--&gt;AddPai[AddPai:无效]; 碰/杠/(点炮)胡HINTOUT graph LR; 胡HINTOUT[碰/杠/胡HINTOUT]--&gt;|IsForce|必出[必须为false,其他玩家出牌后才会出现碰杠胡]; 胡HINTOUT--&gt;|CanPeng|碰[若CanPeng的值为true则填写下一步内容]; 碰--&gt;碰牌[Pengpai:可碰的牌即出牌玩家出的牌]; 胡HINTOUT--&gt;|CanGang|杠[若CanGang的值为true则填写下一步内容]; 杠--&gt;杠list[GangList:可以杠的牌]; 胡HINTOUT --&gt;|CanHu|胡[CanHu的值为true则填写下一步内容]; 胡--&gt;胡牌[HuPai:胡的牌HuMask:胡类型HuTypeNum:胡牌番型]; 胡HINTOUT --&gt; |QiangNum|QiangNum[必填,用于桌面上展示剩余的牌数量]; 胡HINTOUT --&gt; |CursorSeatId| CursorSeatId[必填,牌桌风向标:指向活动玩家这里为出牌玩家座位号]; 胡HINTOUT--&gt;|HasAddPai|派牌[必须为false]; 派牌--&gt;AddPai[AddPai:无效]; 胡HINTOUT --&gt; |SeatId|SeatId[必填,回放使用,当前可以碰/杠/胡的玩家的座位号]; 胡HINTOUT--&gt;|CanOut|出牌[必须为false]; 等待WAITOUT graph LR; 等待[等待WAITOUT] --&gt; |CursorSeatId|出牌玩家[必填,风向标指向出牌的玩家]; 等待--&gt;|HasAddPai|派牌[是否是有系统派牌,有则填写下一步内容]; 派牌--&gt;派牌玩家[AddPaiSeatId:被派牌玩家的座位号]; 等待--&gt;|QiangNum|牌墙[必填,用于桌面展示剩余牌的数量]; 等待--&gt;|IsKeep|IsKeep[玩家做出一个操作后,还需要等待其他玩家操作,则IsKeep=true]; 发牌/同步当前桌子手牌信息 graph LR; 发牌[发牌PBAssignPai]--&gt;|PaiList|手牌[手牌不能为空,不包含已经杠/碰的牌,若是开局后系统发牌则一定为13张]; 发牌--&gt;|Hint|出牌[Hint不为空,则为当前玩家出牌,与Wait互斥]; 发牌--&gt;|Wait|等待[Wait不为空,则等待庄家出牌,与Hint互斥]; 发牌--&gt;|leftPaiNum|左边牌数[给每个玩家发完牌后,起摸点左边剩余的牌,通过骰子获得]; 发牌--&gt;|rightPaiNum|右边牌数[给每个玩家发完牌后,起摸点右边剩余的牌,通过骰子获得]; 发牌--&gt;|syncNumList|牌数量[必填,同步每个玩家的手牌数量,展示其他玩家的牌数量]; 发牌--&gt;|zhuangSeat|庄家[必填,庄家座位号,标识庄家]; 小局结算 graph LR; 结算[小局结算PBSmallSettlement]--&gt;|ID|ID[当前游戏的房间号]; 结算--&gt;|status|房间状态[结算时的房间状态,小局结算时状态为小局结束]; 结算--&gt;|now|当前局数[进行小局结算时的当前局数]; 结算--&gt;|next|下局局数[下局局数,已结束则为0客户端判断是否继续准备]; 结算--&gt;|total|总局数[展示总局数]; 结算--&gt;|name|玩法名称[当前游戏的名称]; 结算--&gt;|doc|玩法描述[游戏玩法的具体描述]; 结算--&gt;|time|时间[展示结束时的时间]; 结算--&gt;|baseScore|房间底分[展示当前游戏的底分] 结算--&gt;|overReason|结束原因[结束原因:解散/结束/局数打满/玩家退出等,用于展示相应提示或动画] 结算--&gt;|overDoc|结束说明[结束文字说明:玩家发起解散/超过局数解散/玩家退出等] 结算--&gt;|dataValid|数据是否有效[数据是否有效,结算前状态不是游戏中,则数据无效] 结算--&gt;|isFlow|是否流局 结算--&gt;|prizeHorseList|奖马[奖马:摸到的奖马牌及是否是马] 结算--&gt;|players|玩家情况[展示每个玩家的数据] 结算的players玩家数据 graph LR; 玩家[players玩家数据]--&gt;|userId|id[玩家ID,用于展示玩家的信息] 玩家--&gt;|NickName|NickName[玩家昵称,用于展示玩家的信息] 玩家--&gt;|WinScore|WinScore[展示本局输赢分数赢为正数,输为负数] 玩家--&gt;|IsBanker|IsBanker[标识是否是庄家] 玩家--&gt;|IsPao|IsPao[标识是否是放炮] 玩家--&gt;|IsHu|IsHu[如果这个玩家是胡牌玩家则填写下一步内容] IsHu--&gt;HuType[HuPai:胡的牌HuType:展示胡牌类型HuTypeNum:胡牌番型] WinScore--&gt;HuScore[HuScore:总胡牌分数GangScore:总的杠分数PrizeHorseScore: 总奖/杀马分数] 玩家--&gt;|HandPaiList|HandPaiList[玩家的手牌] 玩家--&gt;|GangList|GangList[展示玩家所有杠的牌列表] 玩家--&gt;|PengList|PengList[展示玩家所有碰的牌列表] </description>
    </item>
    
    <item>
      <title>牌型测试</title>
      <link>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E7%89%8C%E5%9E%8B%E6%B5%8B%E8%AF%95/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E7%89%8C%E5%9E%8B%E6%B5%8B%E8%AF%95/</guid>
      <description>宜黄麻将/崇仁麻将 抢杠胡 sequenceDiagram participant 玩家一 participant 玩家二 participant 玩家三 participant 玩家四 Note	over 玩家一,玩家四:补牌为：红中--&gt;一万--&gt;红中--&gt;红中--&gt;发财--&gt;一万(抢一万) 玩家一-&gt;&gt;玩家二:出红中 玩家二-&gt;&gt;玩家一:过胡,摸一万,出一万,玩家一可碰 玩家一-&gt;&gt;玩家二:碰一万,出八万 玩家二-&gt;&gt;玩家三:摸红中,过胡,出一张牌 玩家三-&gt;&gt;玩家四:摸红中,出一张牌 玩家四-&gt;&gt;玩家一:摸发财,出发财 玩家一-&gt;&gt;玩家三:摸一万,选择杠,玩家三可以胡 玩家一-&gt;&gt;玩家四:玩家四可以胡 玩家三-&gt;&gt;玩家一:胡 玩家四-&gt;&gt;玩家一:胡 宜黄/崇仁麻将麻将2人场抢杠胡 sequenceDiagram participant 玩家一 participant 玩家二 Note	over 玩家一,玩家二:补牌为：五筒-&gt;四筒-&gt;五筒 玩家一-&gt;&gt;玩家二:出五筒,玩家二可以碰 玩家二--&gt;&gt;玩家一:碰,出白板 玩家一-&gt;&gt;玩家二:摸四筒,出白板 玩家二--&gt;&gt;玩家一:摸五筒,补杠,玩家一可胡 玩家一-&gt;&gt;玩家二:抢杠胡 崇仁麻将点炮胡清一色 sequenceDiagram participant 玩家一 participant 玩家二 participant 玩家三 participant 玩家四 Note	over 玩家一,玩家四:补牌为：一条-&gt;二万-&gt;五条 玩家一-&gt;&gt;玩家三:摸一条出一条,玩家三可以碰 玩家三-&gt;&gt;玩家一:碰一条,出红中,玩家一可以碰 玩家一-&gt;&gt;玩家二:碰红中,出五万 玩家二-&gt;&gt;玩家四:摸二万出二万,玩家四可碰 玩家四-&gt;&gt;玩家三:碰二万,出九条,玩家三可胡 玩家三-&gt;&gt;玩家四:胡九条(选择过胡可以测试假清一色) 玩家三-&gt;&gt;玩家一:选择过胡 玩家一-&gt;&gt;玩家三:摸5条出五条,玩家三可胡 崇仁麻将点炮胡字一色 sequenceDiagram participant 玩家一 participant 玩家二 participant 玩家三 participant 玩家四 Note	over 玩家一,玩家四:补牌为：红中-&gt;二万-&gt;白板 玩家一-&gt;&gt;玩家三:摸红中出红中,玩家三可以碰 玩家三-&gt;&gt;玩家一:碰红中,出九筒,玩家一可以碰 玩家一-&gt;&gt;玩家二:碰九筒,出五万 玩家二-&gt;&gt;玩家四:摸二万出二万,玩家四可碰 玩家四-&gt;&gt;玩家三:碰二万,出南风,玩家三可胡 玩家三-&gt;&gt;玩家四:胡(选择过胡可以测试假字一色) </description>
    </item>
    
    <item>
      <title>扑克流程图</title>
      <link>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E6%89%91%E5%85%8B%E6%B5%81%E7%A8%8B%E5%9B%BE/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%89%96%E6%9E%90/%E6%89%91%E5%85%8B%E6%B5%81%E7%A8%8B%E5%9B%BE/</guid>
      <description>流程图 graph TD 加入房间[加入房间]--&gt;准备[准备] 准备 --&gt;选择包庄 选择包庄--&gt;包庄 选择包庄--&gt;不包庄 不包庄--&gt;|赢家先出|出牌 包庄--&gt;|包庄先出|出牌[出牌/过,必须出牌时不能选择过] 是否结束--&gt;|N|下一个玩家 下一个玩家--&gt;|出牌/过|出牌 结算--&gt;|局数满|房间结束 结算--&gt;|下一局开始|准备 是否结束--&gt;|小局结算|结算 出牌 --&gt;是否结束 出牌 sequenceDiagram 玩家一-&gt;&gt;服务器:出牌|AskOut 服务器--&gt;&gt;玩家一:广播玩家一的出牌|UseOut 服务器--&gt;&gt;玩家二:广播玩家一的出牌|UseOut 服务器--&gt;&gt;玩家三:广播玩家一的出牌|UseOut 服务器--&gt;&gt;玩家四:广播玩家一的出牌|UseOut 服务器-&gt;&gt;玩家二:提示玩家二出牌|hintOut 服务器--&gt;&gt;玩家一:等待玩家二出牌|hintOut 服务器--&gt;&gt;玩家三:等待玩家二出牌|hintOut 服务器--&gt;&gt;玩家四:等待玩家二出牌|hintOut 包庄 sequenceDiagram 服务器-&gt;&gt;玩家一:提示包庄|HintBaoZhuang 服务器--&gt;&gt;玩家二:等待玩家一包庄|HintBaoZhuang 服务器--&gt;&gt;玩家三:等待玩家一包庄|HintBaoZhuang 服务器--&gt;&gt;玩家四:等待玩家一包庄|HintBaoZhuang 玩家一-&gt;&gt;服务器:包庄/不包庄|AskBaoZhuang 服务器--&gt;&gt;玩家一:广播玩家一包庄/不包庄|UseBaoZhuang 服务器--&gt;&gt;玩家二:广播玩家一包庄/不包庄|UseBaoZhuang 服务器--&gt;&gt;玩家三:广播玩家一包庄/不包庄|UseBaoZhuang 服务器--&gt;&gt;玩家四:广播玩家一包庄/不包庄|UseBaoZhuang 过 graph TD; 过--&gt;广播过[广播玩家过牌] 广播过--&gt;上次出牌[判断最近一次出牌是否是自己] 上次出牌--&gt;|是|清除桌子上的牌 清除桌子上的牌--&gt;提示再次出牌 上次出牌--&gt;|否|提示下个玩家出牌 </description>
    </item>
    
  </channel>
</rss>
